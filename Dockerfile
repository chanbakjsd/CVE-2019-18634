FROM ubuntu:20.04

RUN apt update -y
RUN apt upgrade -y
RUN apt install wget gcc make bash python3 -y

WORKDIR /work
RUN wget https://www.sudo.ws/dist/sudo-1.8.25.tar.gz
RUN tar -xzvf ./sudo-1.8.25.tar.gz

WORKDIR /work/sudo-1.8.25
RUN ./configure
RUN make
RUN make install

# Setup environment.
RUN useradd -m -u 1500 user -s /usr/bin/bash
RUN sh -c "printf 'password\npassword\n' | passwd user"
COPY ./sudoers /etc/sudoers

WORKDIR /home/user
COPY exploit.py ./sudo_sudo
CMD ["/bin/su", "user"]
